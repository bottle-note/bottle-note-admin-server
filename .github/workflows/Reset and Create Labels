name: Reset and Create Labels

on:
  workflow_dispatch:
    inputs:
      confirm:
        description: 'ê¸°ì¡´ ë¼ë²¨ ëª¨ë‘ ì‚­ì œí•˜ê³  ìƒˆë¡œ ìƒì„± (yes ì…ë ¥)'
        required: true
        default: 'no'

jobs:
  reset-labels:
    runs-on: ubuntu-latest
    permissions:
      issues: write
      
    steps:
    - name: Reset and Create Labels
      if: github.event.inputs.confirm == 'yes'
      uses: actions/github-script@v7
      with:
        script: |
          // 1. ê¸°ì¡´ ë¼ë²¨ ëª¨ë‘ ì‚­ì œ
          console.log('ğŸ—‘ï¸ ê¸°ì¡´ ë¼ë²¨ ì‚­ì œ ì¤‘...');
          const existing = await github.rest.issues.listLabelsForRepo({
            owner: context.repo.owner,
            repo: context.repo.repo
          });
          
          for (const label of existing.data) {
            try {
              await github.rest.issues.deleteLabel({
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: label.name
              });
              console.log(`  âŒ Deleted: ${label.name}`);
            } catch (e) {
              console.log(`  âš ï¸ Failed to delete: ${label.name}`);
            }
          }
          
          console.log('\nâœ¨ ìƒˆ ë¼ë²¨ ìƒì„± ì¤‘...\n');
          
          // 2. ìƒˆ ë¼ë²¨ ì„¸íŠ¸ ì •ì˜
          const labels = [
            // ğŸ”´ íƒ€ì… ê·¸ë£¹
            {"name": "ğŸ”´ ë²„ê·¸", "color": "d73a4a", "description": "ì˜ˆìƒê³¼ ë‹¤ë¥´ê²Œ ë™ì‘í•˜ëŠ” ë¬¸ì œ"},
            {"name": "ğŸ”´ ìƒˆê¸°ëŠ¥", "color": "ff6b6b", "description": "ìƒˆë¡œìš´ ê¸°ëŠ¥ ê°œë°œ ìš”ì²­"},
            {"name": "ğŸ”´ ë¦¬íŒ©í† ë§", "color": "ff8787", "description": "ì½”ë“œ êµ¬ì¡° ê°œì„  ë° ìµœì í™” ì‘ì—…"},
            {"name": "ğŸ”´ í•«í”½ìŠ¤", "color": "b60205", "description": "ìš´ì˜ì¤‘ ë°œìƒí•œ ê¸´ê¸‰ ìˆ˜ì • ì‚¬í•­"},
            
            // ğŸ”· ì˜ì—­ ê·¸ë£¹
            {"name": "ğŸ”· ë°±ì—”ë“œ", "color": "1d76db", "description": "ì„œë²„, API, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê´€ë ¨"},
            {"name": "ğŸ”· í”„ë¡ íŠ¸ì—”ë“œ", "color": "4dabf7", "description": "UI, UX, í´ë¼ì´ì–¸íŠ¸ í™”ë©´ ê´€ë ¨"},
            {"name": "ğŸ”· ì¸í”„ë¼", "color": "0c8599", "description": "ì„œë²„, ë°°í¬, CI/CD, í´ë¼ìš°ë“œ ê´€ë ¨"},
            {"name": "ğŸ”· ê¸°íš", "color": "6c5ce7", "description": "ê¸°ëŠ¥ ëª…ì„¸, ìš”êµ¬ì‚¬í•­ ì •ì˜ ê´€ë ¨"},
            {"name": "ğŸ”· ë””ìì¸", "color": "a29bfe", "description": "UI ë””ìì¸, ë ˆì´ì•„ì›ƒ, ìŠ¤íƒ€ì¼ ê´€ë ¨"},
            {"name": "ğŸ”· DB", "color": "2e86de", "description": "ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ, ì¿¼ë¦¬, ë§ˆì´ê·¸ë ˆì´ì…˜ ê´€ë ¨"},
            
            // ğŸŸ¢ ì§„í–‰ ìƒíƒœ ê·¸ë£¹
            {"name": "ğŸŸ¢ ì§„í–‰ì¤‘", "color": "fbca04", "description": "í˜„ì¬ ì‘ì—…ì´ ì§„í–‰ë˜ê³  ìˆìŒ"},
            {"name": "ğŸŸ¢ ë¦¬ë·°ëŒ€ê¸°", "color": "ffd43b", "description": "ì½”ë“œ ë¦¬ë·° ë˜ëŠ” ê²€í† ê°€ í•„ìš”í•¨"},
            {"name": "ğŸŸ¢ ì™„ë£Œ", "color": "0e8a16", "description": "ì‘ì—…ì´ ì™„ë£Œë˜ì–´ ì¢…ë£Œë¨"},
            {"name": "ğŸŸ¢ ë³´ë¥˜", "color": "e4e669", "description": "ì¼ì‹œì ìœ¼ë¡œ ì‘ì—…ì´ ì¤‘ë‹¨ë¨"},
            {"name": "ğŸŸ¢ ì¤‘ë‹¨", "color": "cccccc", "description": "ì‘ì—…ì´ ì·¨ì†Œë˜ê±°ë‚˜ íê¸°ë¨"},
            
            // âš¡ ìš°ì„ ìˆœìœ„ ê·¸ë£¹
            {"name": "âš¡ ê¸´ê¸‰", "color": "7950f2", "description": "ì¦‰ì‹œ ì²˜ë¦¬ê°€ í•„ìš”í•œ ìµœìš°ì„  ì‘ì—…"},
            {"name": "âš¡ ë†’ìŒ", "color": "9775fa", "description": "ë¹ ë¥¸ ì‹œì¼ ë‚´ ì²˜ë¦¬ê°€ í•„ìš”í•œ ì‘ì—…"},
            {"name": "âš¡ ë³´í†µ", "color": "b197fc", "description": "ì¼ë°˜ì ì¸ ìš°ì„ ìˆœìœ„ì˜ ì‘ì—…"},
            
            // ğŸ’¬ ê¸°íƒ€ ê·¸ë£¹
            {"name": "ğŸ’¬ ë…¼ì˜í•„ìš”", "color": "d4c5f9", "description": "íŒ€ì›ë“¤ê³¼ í˜‘ì˜ê°€ í•„ìš”í•œ ì‚¬í•­"},
            {"name": "ğŸ’¬ ë¬¸ì„œ", "color": "c5def5", "description": "ë¬¸ì„œí™”, README, ì£¼ì„ ì‘ì—…"},
            {"name": "ğŸ’¬ í…ŒìŠ¤íŠ¸", "color": "bfd4f2", "description": "í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± ë° QA ê´€ë ¨"}
          ];
          
          // 3. ë¼ë²¨ ìƒì„±
          let created = 0;
          let failed = 0;
          
          for (const label of labels) {
            try {
              await github.rest.issues.createLabel({
                owner: context.repo.owner,
                repo: context.repo.repo,
                name: label.name,
                color: label.color,
                description: label.description
              });
              console.log(`  âœ… Created: ${label.name} - "${label.description}"`);
              created++;
            } catch (e) {
              console.log(`  âŒ Failed: ${label.name} - ${e.message}`);
              failed++;
            }
          }
          
          console.log('\n' + '='.repeat(50));
          console.log(`ğŸ“Š ê²°ê³¼: ${created}ê°œ ìƒì„± ì„±ê³µ, ${failed}ê°œ ì‹¤íŒ¨`);
          console.log('='.repeat(50));
          
          // 4. ìµœì¢… ë¼ë²¨ ëª©ë¡ ì¶œë ¥
          console.log('\nğŸ“‹ ìµœì¢… ë¼ë²¨ êµ¬ì„±:');
          console.log('  ğŸ”´ íƒ€ì…: ë²„ê·¸, ìƒˆê¸°ëŠ¥, ë¦¬íŒ©í† ë§, í•«í”½ìŠ¤');
          console.log('  ğŸ”· ì˜ì—­: ë°±ì—”ë“œ, í”„ë¡ íŠ¸ì—”ë“œ, ì¸í”„ë¼, ê¸°íš, ë””ìì¸, DB');
          console.log('  ğŸŸ¢ ìƒíƒœ: ì§„í–‰ì¤‘, ë¦¬ë·°ëŒ€ê¸°, ì™„ë£Œ, ë³´ë¥˜, ì¤‘ë‹¨');
          console.log('  âš¡ ìš°ì„ ìˆœìœ„: ê¸´ê¸‰, ë†’ìŒ, ë³´í†µ');
          console.log('  ğŸ’¬ ê¸°íƒ€: ë…¼ì˜í•„ìš”, ë¬¸ì„œ, í…ŒìŠ¤íŠ¸');
    
    - name: Cancelled
      if: github.event.inputs.confirm != 'yes'
      run: |
        echo "âŒ ì‘ì—… ì·¨ì†Œë¨ - ì‹¤í–‰í•˜ë ¤ë©´ 'yes'ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
        exit 1
