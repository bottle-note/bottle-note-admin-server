<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default.html}">
<head>
    <meta charset="UTF-8">
    <title>위스키 목록</title>
    <th:block layout:fragment="css">
        <style>
            .whiskyItem-filter {
                margin-bottom: 1.5rem;
            }

            .whiskyItem-table img {
                width: 50px;
                height: 50px;
                object-fit: cover;
                border-radius: 4px;
            }

            .action-buttons .btn {
                margin-right: 0.25rem;
            }

            .action-buttons .btn:last-child {
                margin-right: 0;
            }
        </style>
    </th:block>
</head>

<body>
<div layout:fragment="content">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3">위스키 목록</h1>
        <a th:href="@{/whiskyItem/add}" class="btn btn-primary">
            <i class="fas fa-plus"></i> 위스키 추가
        </a>
    </div>
    <div class="card mb-4">
        <div class="card-body">
            <form class="row g-3 whiskyItem-filter">
                <div class="col-md-3">
                    <label for="category" class="form-label">카테고리</label>
                    <select id="category" class="form-select">
                        <option value="">전체</option>
                        <option value="single-malt">싱글 몰트</option>
                        <option value="blended">블렌디드</option>
                        <option value="bourbon">버번</option>
                        <option value="rye">라이</option>
                        <option value="irish">아이리시</option>
                        <option value="other">기타</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="sortBy" class="form-label">정렬</label>
                    <select id="sortBy" class="form-select">
                        <option value="name">이름순</option>
                        <option value="date-desc">최신순</option>
                        <option value="date-asc">오래된순</option>
                        <option value="reviews-desc">리뷰 많은순</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="search" class="form-label">검색</label>
                    <input type="text" class="form-control" id="search" placeholder="위스키 이름 검색">
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button type="button" class="btn btn-primary w-100">
                        <i class="fas fa-search"></i> 검색
                    </button>
                </div>
            </form>
        </div>
    </div>
    <div class="card">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover whiskyItem-table" id="whiskyTable">
                    <thead>
                    <tr>
                        <th style="width: 60px;">이미지</th>
                        <th>이름</th>
                        <th>카테고리</th>
                        <th>도수</th>
                        <th>등록일</th>
                        <th>리뷰 수</th>
                        <th style="width: 150px;">관리</th>
                    </tr>
                    </thead>

                    <tbody>
                    <tr th:each="item : ${whiskyItems}">
                        <td><img th:src="${item.imageUrl}" alt="위스키 이미지"></td>
                        <td th:text="${item.name}"></td>
                        <td th:text="${item.category}"></td>
                        <td th:text="${item.alcoholPercentage + '%'}"></td>
                        <td th:text="${#temporals.format(item.createdAt, 'yyyy-MM-dd')}"></td>
                        <td th:text="${item.reviewCount}"></td>
                        <td class="action-buttons">
                            <a href="#" class="btn btn-sm btn-info" data-bs-toggle="tooltip" title="상세 보기">
                                <i class="fas fa-eye"></i>
                            </a>
                            <a th:href="@{/whiskyItem/edit/{id}(id=${item.id})}" class="btn btn-sm btn-warning" data-bs-toggle="tooltip" title="수정">
                                <i class="fas fa-edit"></i>
                            </a>
                            <button type="button" class="btn btn-sm btn-danger" data-bs-toggle="tooltip" title="삭제">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<th:block layout:fragment="script">
    <script>
        $(document).ready(function () {
            // 테이블 초기화
            initDataTable('whiskyTable', {
                itemsPerPage: 10
            });

            // 툴팁 초기화
            var tooltips = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltips.map(function (tooltip) {
                return new bootstrap.Tooltip(tooltip);
            });

            // 삭제 버튼 클릭 이벤트
            $('.btn-danger').on('click', function () {
                if (confirm('정말로 이 위스키를 삭제하시겠습니까?')) {
                    showAlert('위스키가 삭제되었습니다.', 'success');
                }
            });
        });
    </script>
</th:block>
</body>
</html>
